/*! For license information please see 846.44f40a3d.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[846],{4846:(e,s,n)=>{n.r(s),n.d(s,{default:()=>u});n(5043);var t=n(457),a=n(8628),i=n(2223),l=n(9022),r=n(7784);const c=(0,r.A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var d=n(8384);const o=(0,r.A)("Infinity",[["path",{d:"M12 12c-2-2.67-4-4-6-4a4 4 0 1 0 0 8c2 0 4-1.33 6-4Zm0 0c2 2.67 4 4 6 4a4 4 0 0 0 0-8c-2 0-4 1.33-6 4Z",key:"1z0uae"}]]),x=(0,r.A)("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);var h=n(5727),m=n(579);const u=()=>(0,m.jsxs)("div",{className:"container mt-4",children:[(0,m.jsxs)("h2",{className:"mb-4 text-danger",children:[(0,m.jsx)(l.A,{className:"me-2",size:28}),"Denial of Service (DoS) Vulnerabilities in Solidity"]}),(0,m.jsx)(t.A,{defaultActiveKey:"0",className:"mb-4",children:(0,m.jsxs)(t.A.Item,{eventKey:"0",children:[(0,m.jsxs)(t.A.Header,{children:[(0,m.jsx)(c,{className:"me-2 text-warning",size:20}),"Transaction Revert DoS"]}),(0,m.jsx)(t.A.Body,{children:(0,m.jsx)(a.A,{children:(0,m.jsxs)(a.A.Body,{children:[(0,m.jsx)(a.A.Title,{children:"Vulnerability"}),(0,m.jsx)(a.A.Text,{children:"An attacker can make a contract's receive/fallback function always revert, causing transactions to fail and funds to be locked."}),(0,m.jsx)(a.A.Title,{children:"Proof of Concept"}),(0,m.jsx)("pre",{className:"bg-dark text-light p-3 rounded",children:(0,m.jsx)("code",{children:'// SPDX-License-Identifier: MIT\npragma solidity ^0.8.19;\n\ncontract X {\n  function sendETH(address receiver) external payable {\n    require(msg.value > 0, "amount must >0");\n    (bool sent,) = receiver.call{value: msg.value}("");\n    require(sent, "Transaction Failed@@");\n  }  \n}\n\ncontract Y {\n  uint public balance;\n  \n  receive() external payable { \n    balance += msg.value;\n    revert(" "); // Always reverts\n  }\n}'})}),(0,m.jsx)(a.A.Title,{children:"Mitigation"}),(0,m.jsxs)(i.A,{variant:"flush",children:[(0,m.jsxs)(i.A.Item,{children:[(0,m.jsx)(d.A,{className:"me-2 text-success",size:18}),"Check recipient addresses before making external calls"]}),(0,m.jsxs)(i.A.Item,{children:[(0,m.jsx)(d.A,{className:"me-2 text-success",size:18}),"Use gas limits for external calls: ",(0,m.jsxs)("code",{children:["receiver.call","{value: x, gas: limit}",'("")']})]})]}),(0,m.jsx)(a.A.Title,{className:"mt-3",children:"Real-world Impact"}),(0,m.jsx)(a.A.Text,{children:'In 2020, the "Governor Alpha" contract in Compound had a similar issue where proposals could be made to revert on execution, effectively DoSing the governance system.'})]})})})]})}),(0,m.jsx)(t.A,{className:"mb-4",children:(0,m.jsxs)(t.A.Item,{eventKey:"1",children:[(0,m.jsx)(t.A.Header,{children:"Gas Limit DoS with Loops"}),(0,m.jsx)(t.A.Body,{children:(0,m.jsx)(a.A,{children:(0,m.jsxs)(a.A.Body,{children:[(0,m.jsx)(a.A.Title,{children:"Vulnerability"}),(0,m.jsx)(a.A.Text,{children:"Attackers can use bounded or unbounded loops to consume all gas, causing transactions to fail when block gas limit is exceeded."}),(0,m.jsx)(a.A.Title,{children:"Proof of Concept"}),(0,m.jsx)("pre",{className:"bg-dark text-light p-3 rounded",children:(0,m.jsx)("code",{children:"contract Y {\n  receive() external payable {\n    uint i = 0;\n    while(i < 10000000) { // Infinite loop\n      i += 1;\n    }\n  }\n}"})}),(0,m.jsx)(a.A.Title,{children:"Mitigation"}),(0,m.jsxs)(i.A,{variant:"flush",children:[(0,m.jsxs)(i.A.Item,{children:[(0,m.jsx)(d.A,{className:"me-2 text-success",size:18}),"Avoid unbounded loops in smart contracts"]}),(0,m.jsxs)(i.A.Item,{children:[(0,m.jsx)(d.A,{className:"me-2 text-success",size:18}),"Use pagination for large data sets"]}),(0,m.jsxs)(i.A.Item,{children:[(0,m.jsx)(d.A,{className:"me-2 text-success",size:18}),"Set reasonable upper bounds for iterations"]})]}),(0,m.jsx)(a.A.Title,{className:"mt-3",children:"Real-world Impact"}),(0,m.jsx)(a.A.Text,{children:"Many early Ethereum contracts suffered from gas limit issues when processing arrays of unknown size, making them unusable as the network grew."})]})})})]})}),(0,m.jsx)(t.A,{className:"mb-4",children:(0,m.jsxs)(t.A.Item,{eventKey:"2",children:[(0,m.jsxs)(t.A.Header,{children:[(0,m.jsx)(o,{className:"me-2 text-warning",size:20}),"Liquidity Removal DoS"]}),(0,m.jsx)(t.A.Body,{children:(0,m.jsx)(a.A,{children:(0,m.jsxs)(a.A.Body,{children:[(0,m.jsx)(a.A.Title,{children:"Vulnerability"}),(0,m.jsx)(a.A.Text,{children:"Attackers can rapidly drain liquidity pools by executing multiple swaps in sequence, making future swaps expensive or impossible."}),(0,m.jsx)(a.A.Title,{children:"Proof of Concept"}),(0,m.jsx)("pre",{className:"bg-dark text-light p-3 rounded",children:(0,m.jsx)("code",{children:"interface IDEX {\n  function swap(address tokenA, address tokenB, uint256 amount) external;\n}\n\ncontract LiquidityDrainAttack {\n  IDEX public dex;\n  address public tokenA;\n  address public tokenB;\n\n  constructor(address _dex, address _tokenA, address _tokenB) {\n    dex = IDEX(_dex);\n    tokenA = _tokenA;\n    tokenB = _tokenB;\n  }\n\n  function attack() external {\n    for (uint256 i = 0; i < 100; i++) {\n      dex.swap(tokenA, tokenB, 1000); // Swap multiple times to drain liquidity\n    }\n  }\n}"})}),(0,m.jsx)(a.A.Title,{children:"Mitigation"}),(0,m.jsxs)(i.A,{variant:"flush",children:[(0,m.jsxs)(i.A.Item,{children:[(0,m.jsx)(d.A,{className:"me-2 text-success",size:18}),"Implement swap cooldowns or rate limiting"]}),(0,m.jsxs)(i.A.Item,{children:[(0,m.jsx)(d.A,{className:"me-2 text-success",size:18}),"Use minimum liquidity thresholds"]}),(0,m.jsxs)(i.A.Item,{children:[(0,m.jsx)(d.A,{className:"me-2 text-success",size:18}),"Add transaction size limits"]})]}),(0,m.jsx)(a.A.Title,{className:"mt-3",children:"Real-world Impact"}),(0,m.jsx)(a.A.Text,{children:"Several DEXs have suffered from liquidity draining attacks, especially those with tokens that have transfer fees or burn mechanisms."})]})})})]})}),(0,m.jsx)(t.A,{className:"mb-4",children:(0,m.jsxs)(t.A.Item,{eventKey:"3",children:[(0,m.jsxs)(t.A.Header,{children:[(0,m.jsx)(x,{className:"me-2 text-warning",size:20}),"Reentrancy DoS"]}),(0,m.jsx)(t.A.Body,{children:(0,m.jsx)(a.A,{children:(0,m.jsxs)(a.A.Body,{children:[(0,m.jsx)(a.A.Title,{children:"Vulnerability"}),(0,m.jsx)(a.A.Text,{children:"If a contract processes external calls before updating its state, attackers can repeatedly call a function to block execution."}),(0,m.jsx)(a.A.Title,{children:"Proof of Concept"}),(0,m.jsx)("pre",{className:"bg-dark text-light p-3 rounded",children:(0,m.jsx)("code",{children:'contract ReentrancyDoS {\n  mapping(address => uint256) public balances;\n\n  function deposit() external payable {\n    balances[msg.sender] += msg.value;\n  }\n\n  function withdraw() external {\n    require(balances[msg.sender] > 0, "No balance");\n    (bool success, ) = msg.sender.call{value: balances[msg.sender]}("");\n    require(success, "Transfer failed");\n    balances[msg.sender] = 0; // State update happens after external call\n  }\n}'})}),(0,m.jsx)(a.A.Title,{children:"Mitigation"}),(0,m.jsxs)(i.A,{variant:"flush",children:[(0,m.jsxs)(i.A.Item,{children:[(0,m.jsx)(d.A,{className:"me-2 text-success",size:18}),"Follow Checks-Effects-Interactions pattern"]}),(0,m.jsxs)(i.A.Item,{children:[(0,m.jsx)(d.A,{className:"me-2 text-success",size:18}),"Use OpenZeppelin's ReentrancyGuard"]}),(0,m.jsxs)(i.A.Item,{children:[(0,m.jsx)(d.A,{className:"me-2 text-success",size:18}),"Use call() with gas limits and check return values"]})]}),(0,m.jsx)(a.A.Title,{className:"mt-3",children:"Real-world Impact"}),(0,m.jsx)(a.A.Text,{children:"The famous DAO hack in 2016 was a reentrancy attack that resulted in the loss of 3.6 million ETH and the Ethereum hard fork."})]})})})]})}),(0,m.jsx)(t.A,{className:"mb-4",children:(0,m.jsxs)(t.A.Item,{eventKey:"4",children:[(0,m.jsxs)(t.A.Header,{children:[(0,m.jsx)(h.A,{className:"me-2 text-warning",size:20}),"Unbounded Operations DoS"]}),(0,m.jsx)(t.A.Body,{children:(0,m.jsx)(a.A,{children:(0,m.jsxs)(a.A.Body,{children:[(0,m.jsx)(a.A.Title,{children:"Vulnerability"}),(0,m.jsx)(a.A.Text,{children:"Dynamic or unlimited iterations may cause transactions to fail when processing large data sets."}),(0,m.jsx)(a.A.Title,{children:"Proof of Concept"}),(0,m.jsx)("pre",{className:"bg-dark text-light p-3 rounded",children:(0,m.jsx)("code",{children:"contract X {\n  uint[] public arr;\n  \n  function set(uint n) public {\n    for(uint i = 0; i < n; i++) {\n      arr.push(i);\n    }\n  }\n  \n  // n=10000 causes out of gas error\n}"})}),(0,m.jsx)(a.A.Title,{children:"Mitigation"}),(0,m.jsxs)(i.A,{variant:"flush",children:[(0,m.jsxs)(i.A.Item,{children:[(0,m.jsx)(d.A,{className:"me-2 text-success",size:18}),"Avoid operations that grow with user input"]}),(0,m.jsxs)(i.A.Item,{children:[(0,m.jsx)(d.A,{className:"me-2 text-success",size:18}),"Implement pagination for large data sets"]}),(0,m.jsxs)(i.A.Item,{children:[(0,m.jsx)(d.A,{className:"me-2 text-success",size:18}),"Set reasonable upper bounds for operations"]})]}),(0,m.jsx)(a.A.Title,{className:"mt-3",children:"Real-world Impact"}),(0,m.jsx)(a.A.Text,{children:"Many governance contracts have failed when trying to process large numbers of token holders in a single transaction."})]})})})]})})]})}}]);
//# sourceMappingURL=846.44f40a3d.chunk.js.map