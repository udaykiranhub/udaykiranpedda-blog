/*! For license information please see 120.6c648139.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[120],{4061:(e,s,t)=>{t.d(s,{A:()=>r});const r=(0,t(7784).A)("CodeXml",[["path",{d:"m18 16 4-4-4-4",key:"1inbqp"}],["path",{d:"m6 8-4 4 4 4",key:"15zrgr"}],["path",{d:"m14.5 4-5 16",key:"e7oirm"}]])},4120:(e,s,t)=>{t.r(s),t.d(s,{default:()=>x});t(5043);var r=t(457),i=t(8628),n=t(4196),c=t(2223),a=t(9022),l=t(4061),d=t(7719),o=t(8384),m=t(5727),h=t(579);const x=()=>(0,h.jsxs)("div",{className:"container mt-4",children:[(0,h.jsxs)("h2",{className:"mb-4 text-danger",children:[(0,h.jsx)(a.A,{className:"me-2",size:28}),"tx.origin Authorization Vulnerability"]}),(0,h.jsx)(r.A,{defaultActiveKey:"0",className:"mb-4",children:(0,h.jsxs)(r.A.Item,{eventKey:"0",children:[(0,h.jsxs)(r.A.Header,{children:[(0,h.jsx)(l.A,{className:"me-2 text-warning",size:20}),"tx.origin vs msg.sender Attack"]}),(0,h.jsx)(r.A.Body,{children:(0,h.jsx)(i.A,{children:(0,h.jsxs)(i.A.Body,{children:[(0,h.jsx)(i.A.Title,{children:"Vulnerable Contract"}),(0,h.jsx)("pre",{className:"bg-dark text-light p-3 rounded",children:'contract {\n  address public owner;\n\n  constructor() {\n      owner = msg.sender;\n  }\n\n  function transfer(address payable _to, uint256 _amount) public {\n      require(tx.origin == owner, "Not authorized");\n      _to.transfer(_amount);\n  }\n}'}),(0,h.jsx)(i.A.Title,{children:"Call Structure Analysis"}),(0,h.jsxs)(n.A,{striped:!0,bordered:!0,hover:!0,children:[(0,h.jsx)("thead",{children:(0,h.jsxs)("tr",{children:[(0,h.jsx)("th",{children:"Call Path"}),(0,h.jsx)("th",{children:"msg.sender"}),(0,h.jsx)("th",{children:"tx.origin"})]})}),(0,h.jsxs)("tbody",{children:[(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:"User \u2192 Victim Contract"}),(0,h.jsx)("td",{children:"user"}),(0,h.jsx)("td",{children:"user"})]}),(0,h.jsxs)("tr",{children:[(0,h.jsx)("td",{children:"User \u2192 Attacker Contract \u2192 Victim Contract"}),(0,h.jsx)("td",{children:"Attacker Contract"}),(0,h.jsx)("td",{children:"user"})]})]})]}),(0,h.jsx)(i.A.Title,{children:"Attack Mechanism"}),(0,h.jsxs)(c.A,{variant:"flush",children:[(0,h.jsxs)(c.A.Item,{children:[(0,h.jsx)(d.A,{className:"me-2 text-warning",size:18}),"Victim deploys contract and becomes owner"]}),(0,h.jsxs)(c.A.Item,{children:[(0,h.jsx)(d.A,{className:"me-2 text-warning",size:18}),"Attacker creates malicious contract with call to victim's transfer()"]}),(0,h.jsxs)(c.A.Item,{children:[(0,h.jsx)(d.A,{className:"me-2 text-warning",size:18}),"Victim interacts with attacker's contract (phishing/trickery)"]}),(0,h.jsxs)(c.A.Item,{children:[(0,h.jsx)(d.A,{className:"me-2 text-warning",size:18}),"Call chain: Victim \u2192 Attacker Contract \u2192 Victim Contract"]}),(0,h.jsxs)(c.A.Item,{children:[(0,h.jsx)(d.A,{className:"me-2 text-warning",size:18}),"tx.origin check passes (victim is original EOA)"]})]}),(0,h.jsx)(i.A.Title,{className:"mt-3",children:"Why This Is Dangerous"}),(0,h.jsx)(i.A.Text,{children:"Allows attackers to trick users into unknowingly executing privileged actions. Users may not realize interacting with a malicious dApp can drain their contract."}),(0,h.jsx)(i.A.Title,{className:"mt-3",children:"Mitigation"}),(0,h.jsxs)(c.A,{variant:"flush",children:[(0,h.jsxs)(c.A.Item,{children:[(0,h.jsx)(o.A,{className:"me-2 text-success",size:18}),"NEVER use tx.origin for authorization"]}),(0,h.jsxs)(c.A.Item,{children:[(0,h.jsx)(o.A,{className:"me-2 text-success",size:18}),"Always use msg.sender for access control"]}),(0,h.jsxs)(c.A.Item,{children:[(0,h.jsx)(o.A,{className:"me-2 text-success",size:18}),"Design with composability in mind"]})]}),(0,h.jsx)(i.A.Title,{className:"mt-3",children:"Secure Implementation"}),(0,h.jsx)("pre",{className:"bg-dark text-light p-3 rounded",children:'contract {\n  address public owner;\n\n  constructor() {\n      owner = msg.sender;\n  }\n\n  function transfer(address payable _to, uint256 _amount) public {\n      require(msg.sender == owner, "Not authorized");\n      _to.transfer(_amount);\n  }\n}'}),(0,h.jsx)(i.A.Title,{className:"mt-3",children:"Security Best Practices"}),(0,h.jsxs)(c.A,{variant:"flush",children:[(0,h.jsxs)(c.A.Item,{children:[(0,h.jsx)(m.A,{className:"me-2 text-success",size:18}),"Audit all authorization checks"]}),(0,h.jsxs)(c.A.Item,{children:[(0,h.jsx)(m.A,{className:"me-2 text-success",size:18}),"Assume contracts will be called by other contracts"]}),(0,h.jsxs)(c.A.Item,{children:[(0,h.jsx)(m.A,{className:"me-2 text-success",size:18}),"Validate trust boundaries in external calls"]})]})]})})})]})})]})},4196:(e,s,t)=>{t.d(s,{A:()=>l});var r=t(8139),i=t.n(r),n=t(5043),c=t(7852),a=t(579);const l=n.forwardRef(((e,s)=>{let{bsPrefix:t,className:r,striped:n,bordered:l,borderless:d,hover:o,size:m,variant:h,responsive:x,...j}=e;const u=(0,c.oU)(t,"table"),A=i()(r,u,h&&`${u}-${h}`,m&&`${u}-${m}`,n&&`${u}-${"string"===typeof n?`striped-${n}`:"striped"}`,l&&`${u}-bordered`,d&&`${u}-borderless`,o&&`${u}-hover`),g=(0,a.jsx)("table",{...j,className:A,ref:s});if(x){let e=`${u}-responsive`;return"string"===typeof x&&(e=`${e}-${x}`),(0,a.jsx)("div",{className:e,children:g})}return g}))}}]);
//# sourceMappingURL=120.6c648139.chunk.js.map